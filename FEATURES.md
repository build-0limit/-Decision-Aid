# 功能详解

## ⚙️ 配置中心

### 核心功能
- **可视化配置界面**：无需修改代码或环境变量
- **多服务商支持**：OpenAI、Anthropic、自定义 API
- **本地存储**：配置自动保存到浏览器
- **连接测试**：验证配置是否正确
- **安全管理**：API Key 本地加密存储

### 支持的服务商
1. **演示模式**：使用预设数据，无需 API
2. **OpenAI**：GPT-4、GPT-4 Turbo、GPT-3.5 Turbo
3. **Anthropic**：Claude 3 Opus、Sonnet、Haiku
4. **自定义 API**：任何兼容 OpenAI 格式的 API

### 配置参数
- **API Key**：服务商提供的密钥
- **模型选择**：根据需求选择合适的模型
- **Temperature**：控制输出的随机性（0-2）
- **API 端点**：自定义 API 的完整 URL
- **本地保存**：是否保存配置到浏览器

## 🌳 树形可视化

### 核心特性
- **自动布局算法**：根据决策树结构自动计算节点位置
- **SVG渲染**：使用SVG实现高质量的矢量图形
- **响应式设计**：自动适应容器宽度，支持横向滚动

### 节点类型
1. **普通节点** (❓)：未访问的决策点
2. **已访问节点** (✓)：用户已经经过的节点
3. **当前节点** (👉)：用户当前所在的决策点，带脉冲动画
4. **结果节点** (🎯)：最终的决策结果

### 连接线样式
- **默认状态**：灰色细线
- **已访问路径**：深灰色粗线
- **当前激活路径**：紫色粗线，带流动动画效果

## ✨ 动画效果

### 1. 节点动画
- **脉冲效果**：当前节点持续的缩放脉冲动画
- **图标跳动**：当前节点图标上下跳动
- **悬停效果**：鼠标悬停时节点放大

### 2. 路径动画
- **流动效果**：激活路径的虚线流动动画
- **颜色过渡**：路径状态变化时的平滑颜色过渡

### 3. 界面动画
- **卡片滑入**：决策卡片从下方滑入
- **选项悬停**：选项按钮的滑动和阴影效果
- **进度条**：平滑的进度条填充动画

## 🎮 交互功能

### 用户操作
1. **选择选项**：点击选项按钮进行决策
2. **返回上一步**：支持撤销最后一次选择
3. **查看树结构**：实时查看完整的决策树
4. **点击节点**：可以点击树上的节点（预留交互接口）

### 状态追踪
- **当前位置**：实时高亮显示用户当前所在节点
- **访问历史**：记录并显示用户的完整决策路径
- **进度显示**：顶部进度条显示决策进度

## 🎨 视觉设计

### 色彩方案
- **主色调**：紫色渐变 (#667eea → #764ba2)
- **节点颜色**：
  - 未访问：浅灰色 (#f0f0f0)
  - 已访问：中灰色 (#d0d0d0)
  - 当前：紫色 (#667eea)
  - 结果：绿色 (#4caf50)

### 布局特点
- **居中对齐**：所有内容居中显示
- **卡片设计**：使用圆角卡片和阴影
- **间距合理**：充足的留白和间距
- **层次清晰**：通过大小、颜色、阴影区分层次

## 🔧 技术实现

### 配置管理
```javascript
// 保存配置到 localStorage
setApiConfig(config)

// 读取配置
const config = getApiConfig()

// 测试 API 连接
await testApiConnection(config)
```

### LLM API 调用
- 支持 OpenAI Chat Completions API
- 支持 Anthropic Messages API
- 支持自定义 API 端点
- 自动错误处理和重试
- 失败时回退到演示模式

### 树布局算法
```javascript
// 递归遍历树结构
// 根据深度计算Y坐标
// 根据兄弟节点数量和索引计算X坐标
// 使用贝塞尔曲线连接父子节点
```

### 动画实现
- CSS动画：用于简单的循环动画（脉冲、跳动）
- CSS过渡：用于状态变化的平滑过渡
- SVG动画：用于路径的流动效果

### 响应式策略
- 容器宽度自适应
- SVG尺寸动态计算
- 横向滚动支持
- 移动端优化

## 📊 数据流

```
用户打开配置中心
    ↓
选择服务商和配置参数
    ↓
测试 API 连接（可选）
    ↓
保存配置到 localStorage
    ↓
用户输入问题
    ↓
根据配置调用 LLM API 或使用演示数据
    ↓
LLM生成决策树 JSON
    ↓
计算树布局
    ↓
渲染SVG可视化
    ↓
用户进行选择
    ↓
更新当前节点（带动画）
    ↓
更新访问路径（高亮）
    ↓
继续或得到结果
```

## 🚀 性能优化

- 使用Vue的响应式系统高效更新
- SVG元素复用，减少DOM操作
- 动画使用CSS而非JavaScript
- 合理的组件拆分和懒加载
